
{% extends 'base.html' %}
{% load static %}
{% load i18n %}
{% load currency %}

{% block title %}Phần mềm - Software Store{% endblock %}

{% block extra_head %}
<style>
    /* Hiệu ứng gradient cho các nút */
    .btn-gradient {
      background: linear-gradient(135deg, #6366f1, #4f46e5);
      transition: all 0.3s ease;
      padding: 0.75rem 1.5rem; /* Tăng padding để nút lớn hơn */
      font-weight: 600;
      font-size: 0.95rem; /* Font to hơn */
    }
    .btn-gradient:hover {
      background: linear-gradient(135deg, #4f46e5, #4338ca);
      transform: translateY(-3px); /* Hiệu ứng hover mạnh hơn */
      box-shadow: 0 15px 20px -5px rgba(79, 70, 229, 0.3); /* Shadow đậm hơn */
    }
    
    /* Hiệu ứng thẻ sản phẩm */
    .product-card {
      transition: all 0.3s ease;
      border: 1px solid #e5e7eb;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.08);
      border-radius: 1rem; /* Bo tròn góc nhiều hơn */
      min-width: 280px; /* Set chiều rộng tối thiểu */
      max-width: 100%;
      height: 100%;
      overflow: hidden;
      background: white;
    }
    
    .product-card:hover {
      transform: translateY(-12px); /* Hiệu ứng nâng lên mạnh hơn */
      box-shadow: 0 25px 30px -10px rgba(0, 0, 0, 0.2); /* Shadow đậm hơn */
      border-color: rgba(99, 102, 241, 0.3); /* Viền màu đậm hơn */
      z-index: 10; /* Đẩy lên trên các phần tử khác */
    }
    
    /* Cải thiện khu vực sản phẩm */
    .product-image {
      height: 220px; /* Tăng chiều cao hình ảnh */
      position: relative;
      overflow: hidden;
      background-color: #f5f5f5;
    }
    
    .product-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.5s ease;
    }
    
    .product-card:hover .product-image img {
      transform: scale(1.1); /* Hiệu ứng zoom hình ảnh khi hover */
    }
    
    .product-info {
      padding: 1.5rem;
    }
    
    .product-title {
      font-size: 1.1rem;
      font-weight: 700;
      margin-bottom: 0.75rem;
      display: -webkit-box;
      -webkit-line-clamp: 1;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    
    /* Badge hiệu ứng */
    .badge-pulse {
      animation: pulse 2s infinite;
      padding: 0.5rem 0.75rem !important; /* Tăng kích thước badge */
      font-weight: 600 !important;
      letter-spacing: 0.025em;
    }
    
    /* Category chips */
    .category-chip {
      transition: all 0.3s ease;
      border: 1px solid #e5e7eb;
      padding: 0.5rem 1rem !important;
      font-weight: 500;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    }
    
    .category-chip:hover, .category-chip.active {
      background-color: #4f46e5;
      color: white;
      border-color: #4338ca;
      box-shadow: 0 4px 10px rgba(79, 70, 229, 0.3);
    }
    
    /* Nút add to cart hover */
    .cart-button {
      transition: all 0.3s ease;
      overflow: hidden;
      padding: 0.75rem 1.25rem !important; /* Tăng padding */
      font-size: 0.95rem !important;
      letter-spacing: 0.025em;
      font-weight: 600 !important;
    }
    
    .cart-button .cart-text {
      transition: all 0.3s ease;
    }
    
    .cart-button:hover .cart-icon {
      transform: translateX(-5px) scale(1.3); /* Mạnh hơn */
      animation: bounce 0.5s;
    }
    
    @keyframes bounce {
      0%, 100% { transform: translateX(-5px) scale(1.2); }
      50% { transform: translateX(-8px) scale(1.3); }
    }
    
    .card-sale-badge {
      position: absolute;
      top: -10px;
      right: -10px;
      background: linear-gradient(135deg, #ef4444, #dc2626);
      color: white;
      padding: 0.75rem 1rem; /* Tăng kích thước */
      border-radius: 9999px;
      font-weight: bold;
      font-size: 1rem; /* Tăng kích thước font */
      box-shadow: 0 10px 15px -3px rgba(239, 68, 68, 0.4); /* Shadow mạnh hơn */
      z-index: 10;
      transform: rotate(15deg);
    }
    
    /* Cải thiện hiệu ứng glass */
    .glass-effect {
      background: rgba(255, 255, 255, 0.75); /* Tăng độ mờ */
      backdrop-filter: blur(12px); /* Tăng độ blur */
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.3);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    }
    
    /* Cải thiện hiệu ứng nền */
    .hero-pattern {
      background-color: #f9fafb;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80' viewBox='0 0 80 80'%3E%3Cg fill='%23e5e7eb' fill-opacity='0.4'%3E%3Cpath fill-rule='evenodd' d='M0 0h40v40H0V0zm40 40h40v40H40V40zm0-40h2l-2 2V0zm0 4l4-4h2l-6 6V4zm0 4l8-8h2L40 10V8zm0 4L52 0h2L40 14v-2zm0 4L56 0h2L40 18v-2zm0 4L60 0h2L40 22v-2zm0 4L64 0h2L40 26v-2zm0 4L68 0h2L40 30v-2zm0 4L72 0h2L40 34v-2zm0 4L76 0h2L40 38v-2zm0 4L80 0v2L42 40h-2zm4 0L80 4v2L46 40h-2zm4 0L80 8v2L50 40h-2zm4 0l28-28v2L54 40h-2zm4 0l24-24v2L58 40h-2zm4 0l20-20v2L62 40h-2zm4 0l16-16v2L66 40h-2zm4 0l12-12v2L70 40h-2zm4 0l8-8v2l-6 6h-2zm4 0l4-4v2l-2 2h-2z'/%3E%3C/g%3E%3C/svg%3E");
    }
    
    @keyframes pulse {
      0% {
        box-shadow: 0 0 0 0 rgba(99, 102, 241, 0.9); /* Tăng độ đậm */
      }
      70% {
        box-shadow: 0 0 0 15px rgba(99, 102, 241, 0); /* Tăng độ lớn */
      }
      100% {
        box-shadow: 0 0 0 0 rgba(99, 102, 241, 0);
      }
    }
    
    /* Điều chỉnh hiệu ứng loading */
    .skeleton {
      background: linear-gradient(90deg, #f3f4f6 0%, #e5e7eb 50%, #f3f4f6 100%);
      background-size: 200% 100%;
      animation: skeleton-loading 1.2s infinite; /* Tăng tốc độ */
      border-radius: 0.5rem;
    }
    
    @keyframes skeleton-loading {
      0% {
        background-position: 200% 0;
      }
      100% {
        background-position: -200% 0;
      }
    }
    
    /* Cải thiện hệ thống đánh giá sao */
    .stars-container {
      display: inline-block;
      position: relative;
      color: #d1d5db; /* Default gray stars */
      font-size: 1.2rem; /* Tăng kích thước sao */
      line-height: 1;
    }
    
    .stars-filled {
      position: absolute;
      top: 0;
      left: 0;
      white-space: nowrap;
      overflow: hidden;
      color: #fbbf24; /* Yellow filled stars */
      text-shadow: 0 0 2px rgba(251, 191, 36, 0.3); /* Thêm glow effect */
    }
    
    /* Điều chỉnh layout grid để box lớn hơn */
    .product-grid {
      display: grid;
      grid-template-columns: repeat(1, 1fr);
      gap: 1.5rem;
    }
    
    @media (min-width: 640px) {
      .product-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }
    
    @media (min-width: 1024px) {
      .product-grid {
        grid-template-columns: repeat(3, 1fr) !important; /* Force 3 columns thay vì 4 */
        gap: 2rem !important;
      }
    }
    
    /* Hiệu ứng hover cho chi tiết sản phẩm */
    .product-detail-button {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.8);
      opacity: 0;
      transition: all 0.3s ease;
    }
    
    .product-card:hover .product-detail-button {
      opacity: 1;
      transform: translate(-50%, -50%) scale(1);
    }
    
    /* Cải thiện hiển thị giá */
    .product-price {
      font-size: 1.5rem;
      font-weight: 700;
      color: #111827;
    }
    
    .product-price-original {
      font-size: 1rem;
      color: #9ca3af;
      text-decoration: line-through;
      margin-left: 0.5rem;
    }
    
    /* Hiệu ứng badge "Mới" */
    .new-badge {
      position: absolute;
      top: 1rem;
      left: 1rem;
      background: linear-gradient(135deg, #10b981, #059669);
      color: white;
      padding: 0.5rem 0.75rem;
      border-radius: 9999px;
      font-weight: bold;
      font-size: 0.875rem;
      box-shadow: 0 10px 15px -3px rgba(16, 185, 129, 0.3);
      z-index: 10;
    }
  </style>
{% endblock %}

{% block content %}
<!-- Hero Section with Pattern Background -->
<div class="hero-pattern py-16">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
    <h1 class="text-4xl md:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 to-purple-600 mb-4">
      Thư Viện Phần Mềm
    </h1>
    <p class="text-lg text-gray-600 max-w-3xl mx-auto">
      Khám phá bộ sưu tập phần mềm cao cấp chất lượng cao, được tuyển chọn bởi chuyên gia công nghệ hàng đầu. Nâng cấp trải nghiệm kỹ thuật số của bạn ngay hôm nay!
    </p>
    
    <!-- Category Pills/Chips -->
    <div class="mt-8 flex flex-wrap justify-center gap-2">
      <a href="{% url 'products:list' %}" class="category-chip px-4 py-2 rounded-full text-sm font-medium bg-indigo-100 text-indigo-800 hover:bg-indigo-600 hover:text-white transition-all duration-300 {% if not request.GET.category %}active bg-indigo-600 text-white{% endif %}">
        Tất cả
      </a>
      {% for category in categories %}
        <a href="?category={{ category.id }}" class="category-chip px-4 py-2 rounded-full text-sm font-medium bg-indigo-100 text-indigo-800 hover:bg-indigo-600 hover:text-white transition-all duration-300 {% if request.GET.category == category.id|stringformat:'i' %}active bg-indigo-600 text-white{% endif %}">
          {{ category.name }}
        </a>
      {% endfor %}
    </div>
  </div>
</div>

<div class="bg-gray-50">
  <div class="max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8">
    <!-- Search and Filter -->
    <div class="bg-white rounded-xl shadow-xl p-6 mb-12 transform transition-transform duration-300 hover:scale-[1.01]">
      <h2 class="text-xl font-bold text-gray-900 mb-6 flex items-center">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2 text-indigo-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" />
        </svg>
        Tìm kiếm & Lọc
      </h2>
      <form method="get" class="space-y-6">
        <div class="grid grid-cols-1 gap-y-6 sm:grid-cols-2 lg:grid-cols-4 gap-x-6">
          <div class="group">
            <label for="query" class="block text-sm font-medium text-gray-700 group-hover:text-indigo-600 transition-colors duration-300">Tìm kiếm</label>
            <div class="mt-1 relative rounded-md shadow-sm">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <svg class="h-5 w-5 text-gray-400 group-hover:text-indigo-600 transition-colors duration-300" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
                </svg>
              </div>
              <input type="text" name="query" id="query" value="{{ request.GET.query }}" 
                     class="pl-10 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm transition-all duration-300"
                     placeholder="Tên phần mềm...">
            </div>
          </div>
          
          <div class="group">
            <label for="category" class="block text-sm font-medium text-gray-700 group-hover:text-indigo-600 transition-colors duration-300">Danh mục</label>
            <select name="category" id="category" 
                    class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm transition-all duration-300">
              <option value="">Tất cả danh mục</option>
              {% for category in categories %}
                <option value="{{ category.id }}" {% if request.GET.category == category.id|stringformat:"i" %}selected{% endif %}>
                  {{ category.name }}
                </option>
              {% endfor %}
            </select>
          </div>
          
          <div class="group">
            <label for="software_type" class="block text-sm font-medium text-gray-700 group-hover:text-indigo-600 transition-colors duration-300">Loại</label>
            <select name="software_type" id="software_type" 
                    class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm transition-all duration-300">
              <option value="">Tất cả loại</option>
              {% for value, label in product.SOFTWARE_TYPES %}
                <option value="{{ value }}" {% if request.GET.software_type == value %}selected{% endif %}>
                  {{ label }}
                </option>
              {% endfor %}
            </select>
          </div>
          
          <div class="group">
            <label for="min_price" class="block text-sm font-medium text-gray-700 group-hover:text-indigo-600 transition-colors duration-300">Khoảng giá</label>
            <div class="mt-1 flex space-x-2">
              <div class="relative rounded-md shadow-sm flex-1">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                  <span class="text-gray-500 sm:text-sm">$</span>
                </div>
                <input type="number" name="min_price" id="min_price" value="{{ request.GET.min_price }}" 
                       class="pl-7 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm transition-all duration-300"
                       placeholder="Min">
              </div>
              <div class="relative rounded-md shadow-sm flex-1">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                  <span class="text-gray-500 sm:text-sm">$</span>
                </div>
                <input type="number" name="max_price" id="max_price" value="{{ request.GET.max_price }}" 
                       class="pl-7 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm transition-all duration-300"
                       placeholder="Max">
              </div>
            </div>
          </div>
        </div>
        
        <div class="flex justify-end">
          <button type="submit" 
                  class="btn-gradient inline-flex items-center px-6 py-3 border border-transparent text-sm font-medium rounded-lg shadow-md text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
            <svg class="h-5 w-5 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M3 3a1 1 0 011-1h12a1 1 0 011 1v3a1 1 0 01-.293.707L12 11.414V15a1 1 0 01-.293.707l-2 2A1 1 0 018 17v-5.586L3.293 6.707A1 1 0 013 6V3z" clip-rule="evenodd" />
            </svg>
            Áp dụng bộ lọc
          </button>
        </div>
      </form>
    </div>

    <!-- Featured Products -->
    {% if featured_products %}
      <div class="bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl shadow-xl p-8 mb-12 relative overflow-hidden">
        <!-- Decorative Elements -->
        <div class="absolute top-0 right-0 opacity-40 transform translate-x-1/4 -translate-y-1/4">
          <svg xmlns="http://www.w3.org/2000/svg" width="320" height="320" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="text-indigo-300">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
          </svg>
        </div>
        
        <div class="relative">
          <h2 class="text-2xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 to-purple-600 mb-6 flex items-center">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z" />
            </svg>
            Sản phẩm nổi bật
          </h2>
          
          <div class="grid grid-cols-1 gap-y-8 gap-x-6 sm:grid-cols-2 lg:grid-cols-4 xl:gap-x-8">
            {% for product in featured_products %}
              <div class="product-card bg-white rounded-xl shadow-md overflow-hidden relative">
                {% if forloop.first %}
                  <div class="card-sale-badge">
                    -20%
                  </div>
                {% endif %}
                
                <div class="relative">
                  <div class="w-full h-60 bg-gray-200 overflow-hidden">
                    <img src="{{ product.thumbnail.url }}" 
                         alt="{{ product.name }}" 
                         class="w-full h-full object-center object-cover transition-transform duration-500 group-hover:scale-110">
                  </div>
                  <div class="absolute top-2 right-2">
                    <span class="badge-pulse inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800 border border-indigo-300">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-indigo-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />
                      </svg>
                      Nổi bật
                    </span>
                  </div>
                </div>
                
                <div class="p-5">
                  <div class="flex justify-between items-start">
                    <h3 class="text-base font-bold text-gray-900 line-clamp-1 hover:text-indigo-600 transition-colors duration-300">
                      <a href="{% url 'products:detail' product.id %}">
                        {{ product.name }}
                      </a>
                    </h3>
                    <div class="bg-gray-100 rounded-md px-2 py-1 text-xs font-medium text-gray-600">
                      v{{ product.version }}
                    </div>
                  </div>
                  
                  <div class="mt-1 flex items-center">
                    <div class="stars-container">
                      <div class="stars-background">★★★★★</div>
                      <div class="stars-filled" style="width: {{ product.average_rating|default:4.5|floatformat:1|multiply:20 }}%">★★★★★</div>
                    </div>
                    <span class="ml-1 text-xs text-gray-500">({{ product.reviews.count|default:32 }})</span>
                  </div>
                  
                  <p class="mt-1 text-sm text-indigo-600 font-medium flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z" />
                    </svg>
                    {{ product.category.name }}
                  </p>
                  
                  <div class="mt-2 flex text-xs space-x-2">
                    <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                      {{ product.get_software_type_display }}
                    </span>
                    <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                      {{ product.supported_platforms }}
                    </span>
                  </div>
                  
                  <div class="mt-4 flex items-center justify-between">
                    <div>
                      <p class="text-xl font-bold text-gray-900">{{ product.price|currency }}</p>
                      {% if forloop.first %}
                        <p class="text-sm text-gray-500 line-through">{{ product.price|multiply:1.2|currency }}</p>
                      {% endif %}
                    </div>
                    <form method="post" action="{% url 'orders:add_to_cart' product.id %}" class="inline">
                      {% csrf_token %}
                      <button type="submit" 
                              class="cart-button btn-gradient inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-lg text-white">
                        <svg class="cart-icon h-5 w-5 mr-1 transition-transform duration-300" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                          <path d="M3 1a1 1 0 000 2h1.22l.305 1.222a.997.997 0 00.01.042l1.358 5.43-.893.892C3.74 11.846 4.632 14 6.414 14H15a1 1 0 000-2H6.414l1-1H14a1 1 0 00.894-.553l3-6A1 1 0 0017 3H6.28l-.31-1.243A1 1 0 005 1H3zM16 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM6.5 18a1.5 1.5 0 100-3 1.5 1.5 0 000 3z" />
                        </svg>

                      </button>
                    </form>
                  </div>
                </div>
              </div>
            {% endfor %}
          </div>
        </div>
      </div>
    {% endif %}

    <!-- All Products Section -->
    <div class="bg-white rounded-xl shadow-xl p-8 relative overflow-hidden">
      <div class="absolute bottom-0 left-0 w-full h-1/2 bg-gradient-to-t from-indigo-50 to-transparent opacity-50"></div>
      
      <div class="relative">
        <h2 class="text-2xl font-extrabold text-gray-900 mb-6 flex items-center">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 mr-2 text-indigo-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
          </svg>
          Tất cả sản phẩm
        </h2>
        
        <div class="grid grid-cols-1 gap-y-8 gap-x-6 sm:grid-cols-2 lg:grid-cols-4 xl:gap-x-8">
          {% for product in products %}
            <div class="product-card bg-white rounded-xl shadow-md overflow-hidden relative">
              {% if product.is_new %}
                <div class="absolute top-2 left-2 z-10">
                  <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 border border-green-300">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                    </svg>
                    Mới
                  </span>
                </div>
              {% endif %}
              
              <div class="relative group">
                <div class="w-full h-60 bg-gray-200 overflow-hidden">
                  <img src="{{ product.thumbnail.url }}" 
                       alt="{{ product.name }}" 
                       class="w-full h-full object-center object-cover transition-transform duration-500 group-hover:scale-110">
                </div>
                
                <!-- Quick actions overlay -->
                <div class="absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                  <div class="glass-effect rounded-lg flex space-x-2 p-2">
                    <a href="{% url 'products:detail' product.id %}" class="p-2 rounded-full bg-white text-indigo-600 hover:bg-indigo-600 hover:text-white transition-colors duration-300" title="Xem chi tiết">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.5427.057 19 12c-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7z" />
                      </svg>
                    </a>
                    <button type="submit" form="add-to-cart-{{ product.id }}" class="p-2 rounded-full bg-white text-indigo-600 hover:bg-indigo-600 hover:text-white transition-colors duration-300" title="Thêm vào giỏ hàng">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
                      </svg>
                    </button>
                    <a href="#" class="p-2 rounded-full bg-white text-pink-600 hover:bg-pink-600 hover:text-white transition-colors duration-300" title="Thêm vào yêu thích">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
                      </svg>
                    </a>
                  </div>
                </div>
              </div>
              
              <div class="p-5">
                <div class="flex justify-between items-start">
                  <h3 class="text-base font-bold text-gray-900 line-clamp-1 hover:text-indigo-600 transition-colors duration-300">
                    <a href="{% url 'products:detail' product.id %}">
                      {{ product.name }}
                    </a>
                  </h3>
                  <div class="bg-gray-100 rounded-md px-2 py-1 text-xs font-medium text-gray-600">
                    v{{ product.version }}
                  </div>
                </div>
                
                <div class="mt-1 flex items-center">
                  <div class="stars-container">
                    <div class="stars-background">★★★★★</div>
                    <div class="stars-filled" style="width: {{ product.average_rating|default:4.2|floatformat:1|multiply:20 }}%">★★★★★</div>
                  </div>
                  <span class="ml-1 text-xs text-gray-500">({{ product.reviews.count|default:18 }})</span>
                </div>
                
                <p class="mt-1 text-sm text-indigo-600 font-medium flex items-center">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z" />
                  </svg>
                  {{ product.category.name }}
                </p>
                
                <div class="mt-2 flex text-xs space-x-2">
                  <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                    {{ product.get_software_type_display }}
                  </span>
                  <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                    {{ product.supported_platforms }}
                  </span>
                </div>
                
                <div class="mt-4 flex items-center justify-between">
                  <div>
                    <p class="text-xl font-bold text-gray-900">{{ product.price|currency }}</p>
                    {% if product.on_sale %}
                      <p class="text-sm text-gray-500 line-through">{{ product.original_price|currency }}</p>
                    {% endif %}
                  </div>
                  <form method="post" action="{% url 'orders:add_to_cart' product.id %}" id="add-to-cart-{{ product.id }}" class="inline">
                    {% csrf_token %}
                    <button type="submit" 
                            class="cart-button btn-gradient inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-lg text-white">
                      <svg class="cart-icon h-5 w-5 mr-1 transition-transform duration-300" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M3 1a1 1 0 000 2h1.22l.305 1.222a.997.997 0 00.01.042l1.358 5.43-.893.892C3.74 11.846 4.632 14 6.414 14H15a1 1 0 000-2H6.414l1-1H14a1 1 0 00.894-.553l3-6A1 1 0 0017 3H6.28l-.31-1.243A1 1 0 005 1H3zM16 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM6.5 18a1.5 1.5 0 100-3 1.5 1.5 0 000 3z" />
                      </svg>

                    </button>
                  </form>
                </div>
              </div>
            </div>
          {% empty %}
            <div class="col-span-full py-16 text-center">
              <div class="inline-block p-6 rounded-full bg-indigo-50 mb-4">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-indigo-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
              </div>
              <h3 class="text-lg font-medium text-gray-900 mb-2">Không tìm thấy sản phẩm</h3>
              <p class="text-gray-500 max-w-md mx-auto mb-6">Không tìm thấy sản phẩm phù hợp với tiêu chí của bạn. Hãy thử tìm kiếm với các điều kiện khác.</p>
              
              <a href="{% url 'products:list' %}" class="inline-flex items-center text-sm font-medium text-indigo-600 hover:text-indigo-500 transition-colors duration-300">
                <svg class="h-5 w-5 mr-1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L4.414 9H17a1 1 0 110 2H4.414l5.293 5.293a1 1 0 010 1.414z" clip-rule="evenodd" />
                </svg>
                Xem tất cả sản phẩm
              </a>
            </div>
          {% endfor %}
        </div>
        
        <!-- Hiệu ứng quảng cáo thêm -->
        {% if products %}
          <div class="mt-16 relative">
            <div class="bg-gradient-to-r from-purple-600 to-indigo-600 rounded-xl shadow-lg overflow-hidden">
              <div class="relative z-10 md:flex md:items-center py-8 px-6 md:px-10 md:py-10">
                <div class="flex-1 md:mr-10">
                  <h3 class="text-2xl font-extrabold tracking-tight text-white">Nâng cấp trải nghiệm của bạn</h3>
                  <p class="mt-3 max-w-3xl text-lg text-purple-200">
                    Mua gói sản phẩm với giá cực hấp dẫn - tiết kiệm đến 40% so với mua lẻ. Bạn còn chần chừ gì nữa?
                  </p>
                  <div class="mt-6">
                    <a href="#" class="inline-flex items-center px-6 py-3 border border-transparent shadow-sm text-base font-medium rounded-md text-indigo-600 bg-white hover:bg-gray-50 transition-colors duration-300">
                      Xem gói phần mềm
                      <svg xmlns="http://www.w3.org/2000/svg" class="ml-3 -mr-1 h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6" />
                      </svg>
                    </a>
                  </div>
                </div>
                <div class="flex-shrink-0 mt-6 md:mt-0">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-32 w-32 text-white opacity-25" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4" />
                  </svg>
                </div>
                
                <!-- Decorative elements -->
                <div class="absolute inset-0 z-0 overflow-hidden opacity-20">
                  <svg class="absolute -bottom-48 -right-48 h-96 w-96" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0.5" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10" />
                    <path d="M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z" />
                  </svg>
                  <svg class="absolute -top-40 -left-40 h-80 w-80" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0.5" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
                    <line x1="3" y1="9" x2="21" y2="9" />
                    <line x1="3" y1="15" x2="21" y2="15" />
                    <line x1="9" y1="3" x2="9" y2="21" />
                    <line x1="15" y1="3" x2="15" y2="21" />
                  </svg>
                </div>
              </div>
            </div>
          </div>
        {% endif %}
      </div>
    </div>

    <!-- Pagination -->
    {% if is_paginated %}
      <div class="mt-12">
        <nav class="flex justify-center" aria-label="Pagination">
          <div class="relative z-0 inline-flex rounded-md shadow-sm -space-x-px overflow-hidden">
            {% if page_obj.has_previous %}
              <a href="?page={{ page_obj.previous_page_number }}{% if request.GET.query %}&query={{ request.GET.query }}{% endif %}{% if request.GET.category %}&category={{ request.GET.category }}{% endif %}{% if request.GET.software_type %}&software_type={{ request.GET.software_type }}{% endif %}{% if request.GET.min_price %}&min_price={{ request.GET.min_price }}{% endif %}{% if request.GET.max_price %}&max_price={{ request.GET.max_price }}{% endif %}" 
                 class="relative inline-flex items-center px-3 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 transition-colors duration-300">
                <span class="sr-only">Previous</span>
                <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" />
                </svg>
              </a>
            {% else %}
              <span class="relative inline-flex items-center px-3 py-2 rounded-l-md border border-gray-300 bg-gray-100 text-sm font-medium text-gray-400 cursor-not-allowed">
                <span class="sr-only">Previous</span>
                <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" />
                </svg>
              </span>
            {% endif %}

            {% for num in page_obj.paginator.page_range %}
              {% if page_obj.number == num %}
                <span class="relative inline-flex items-center px-4 py-2 border border-indigo-500 bg-indigo-50 text-sm font-medium text-indigo-600">
                  {{ num }}
                </span>
              {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
                <a href="?page={{ num }}{% if request.GET.query %}&query={{ request.GET.query }}{% endif %}{% if request.GET.category %}&category={{ request.GET.category }}{% endif %}{% if request.GET.software_type %}&software_type={{ request.GET.software_type }}{% endif %}{% if request.GET.min_price %}&min_price={{ request.GET.min_price }}{% endif %}{% if request.GET.max_price %}&max_price={{ request.GET.max_price }}{% endif %}" 
                   class="relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors duration-300">
                  {{ num }}
                </a>
              {% endif %}
            {% endfor %}

            {% if page_obj.has_next %}
              <a href="?page={{ page_obj.next_page_number }}{% if request.GET.query %}&query={{ request.GET.query }}{% endif %}{% if request.GET.category %}&category={{ request.GET.category }}{% endif %}{% if request.GET.software_type %}&software_type={{ request.GET.software_type }}{% endif %}{% if request.GET.min_price %}&min_price={{ request.GET.min_price }}{% endif %}{% if request.GET.max_price %}&max_price={{ request.GET.max_price }}{% endif %}" 
                 class="relative inline-flex items-center px-3 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 transition-colors duration-300">
                <span class="sr-only">Next</span>
                <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd" />
                </svg>
              </a>
            {% else %}
              <span class="relative inline-flex items-center px-3 py-2 rounded-r-md border border-gray-300 bg-gray-100 text-sm font-medium text-gray-400 cursor-not-allowed">
                <span class="sr-only">Next</span>
                <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd" />
                </svg>
              </span>
            {% endif %}
          </div>
        </nav>
      </div>
    {% endif %}
    
    <!-- Newsletter signup -->
    <div class="mt-16 bg-gradient-to-r from-teal-500 to-cyan-600 rounded-xl shadow-xl overflow-hidden">
      <div class="px-6 py-10 sm:px-12 sm:py-16 lg:flex lg:items-center">
        <div class="lg:w-0 lg:flex-1">
          <h2 class="text-2xl font-extrabold tracking-tight text-white sm:text-3xl">
            Nhận thông báo về phần mềm mới
          </h2>
          <p class="mt-3 max-w-3xl text-lg text-cyan-100">
            Đăng ký để nhận thông báo về các phần mềm mới, ưu đãi đặc biệt, và tài liệu hướng dẫn độc quyền.
          </p>
        </div>
        <div class="mt-8 lg:mt-0 lg:ml-8">
          <form class="sm:flex">
            <label for="email-address" class="sr-only">Email address</label>
            <input id="email-address" name="email-address" type="email" autocomplete="email" required class="w-full px-5 py-3 border-0 shadow-md focus:ring-2 focus:ring-white focus:outline-none rounded-md placeholder-gray-500" placeholder="Nhập email của bạn">
            <button type="submit" class="mt-3 w-full px-5 py-3 rounded-md shadow text-base font-medium text-white bg-teal-800 hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-white sm:mt-0 sm:ml-3 sm:w-auto sm:flex-shrink-0 transition-colors duration-300">
              Đăng ký ngay
            </button>
          </form>
          <p class="mt-3 text-sm text-cyan-100">
            Chúng tôi quan tâm đến dữ liệu của bạn. Đọc 
            <a href="#" class="text-white font-medium underline hover:text-cyan-50">
              Chính sách bảo mật
            </a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Floating action button -->
<a href="#" class="fixed right-6 bottom-6 p-3 rounded-full shadow-lg bg-indigo-600 text-white hover:bg-indigo-700 transition-all duration-300 transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 z-50">
  <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 11l7-7 7 7M5 19l7-7 7 7" />
  </svg>
</a>

<!-- Thêm script để animation scroll trôi mượt -->
<script>
  // Hiệu ứng smooth scroll khi click FAB
  document.addEventListener('DOMContentLoaded', function() {
    const scrollToTopButton = document.querySelector('a[href="#"]');
    scrollToTopButton.addEventListener('click', function(e) {
      e.preventDefault();
      window.scrollTo({
        top: 0,
        behavior: 'smooth'
      });
    });
    
    // Hiển thị hoặc ẩn FAB dựa vào vị trí scroll
    function toggleScrollButton() {
      const scrollToTopButton = document.querySelector('a[href="#"]');
      if (window.pageYOffset > 300) {
        scrollToTopButton.classList.remove('opacity-0', 'pointer-events-none');
        scrollToTopButton.classList.add('opacity-100');
      } else {
        scrollToTopButton.classList.add('opacity-0', 'pointer-events-none');
        scrollToTopButton.classList.remove('opacity-100');
      }
    }
    
    // Ẩn FAB khi load trang
    scrollToTopButton.classList.add('opacity-0', 'pointer-events-none');
    
    // Theo dõi sự kiện scroll
    window.addEventListener('scroll', toggleScrollButton);
  });
</script>
{% endblock %}